<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="Haiyu.Pages.SettingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:a="using:Haiyu"
    xmlns:controls="using:Haiyu.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ext="using:Haiyu.Plugin.Extensions"
    xmlns:gamer="using:Waves.Api.Models.Communitys"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:item="using:Haiyu.Models"
    xmlns:local="using:Haiyu.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:uModel="using:Haiyu.ViewModel"
    xmlns:ui="using:CommunityToolkit.WinUI.Controls"
    xmlns:wui="using:Haiyu.Controls"
    mc:Ignorable="d">
    <i:Interaction.Behaviors>
        <i:EventTriggerBehavior EventName="Loaded">
            <i:InvokeCommandAction Command="{x:Bind ViewModel.LoadedCommand}" />
        </i:EventTriggerBehavior>
    </i:Interaction.Behaviors>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <ProgressBar
            HorizontalAlignment="Stretch"
            Background="Transparent"
            IsIndeterminate="{x:Bind ViewModel.ProgressAction, Mode=OneWay}" />
        <ScrollView
            Grid.Row="1"
            Padding="25"
            HorizontalScrollBarVisibility="Hidden"
            VerticalScrollBarVisibility="Hidden">
            <StackPanel HorizontalAlignment="Stretch">
                <StackPanel.ChildrenTransitions>
                    <TransitionCollection>
                        <EntranceThemeTransition FromVerticalOffset="50" IsStaggeringEnabled="True" />
                        <RepositionThemeTransition />
                    </TransitionCollection>
                </StackPanel.ChildrenTransitions>
                <Grid Height="200">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid
                        Grid.RowSpan="3"
                        Margin="15,0,0,0"
                        Padding="10"
                        VerticalAlignment="Center"
                        Background="{ThemeResource AccentAAFillColorDisabledBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="4"
                        CornerRadius="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <controls:ImageEx
                            Width="45"
                            Height="45"
                            Margin="5"
                            Source="ms-appx:///Assets/GameIcons/global.ico" />

                        <controls:ImageEx
                            Grid.Column="1"
                            Width="45"
                            Height="45"
                            Margin="5"
                            Source="ms-appx:///Assets/GameIcons/pgr.ico" />
                        <controls:ImageEx
                            Grid.Row="1"
                            Grid.ColumnSpan="2"
                            Width="45"
                            Height="45"
                            Margin="5"
                            Source="ms-appx:///Assets/appLogo.png" />
                    </Grid>
                    <Border
                        Grid.RowSpan="3"
                        Grid.ColumnSpan="2"
                        Background="{ThemeResource CardGradient2Brush}"
                        Canvas.ZIndex="-1"
                        CornerRadius="5" />
                    <TextBlock
                        Grid.Column="1"
                        Margin="15,20,0,0"
                        VerticalAlignment="Center"
                        FontFamily="{ThemeResource DefaultFont}"
                        FontSize="25"
                        Text="Haiyu" />
                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="15,0,15,0"
                        FontFamily="{ThemeResource DefaultFont}"
                        Text="Haiyu是一款针对于鸣潮、战双帕弥什两款游戏的启动器，其中包含了社区工具的一些功能，集抽卡记录、记录分析、鸣潮数据面板、游戏资源维护、轻量化等功能。"
                        TextWrapping="WrapWholeWords" />
                    <StackPanel
                        Grid.Row="2"
                        Grid.Column="1"
                        Margin="15,0,0,30"
                        Orientation="Horizontal">
                        <HyperlinkButton Content="Github" NavigateUri="https://github.com/BlameTwo/Haiyu" />
                        <HyperlinkButton Content="鸣潮官网" NavigateUri="https://mc.kurogames.com/" />
                        <HyperlinkButton Content="战双帕弥什官网" NavigateUri="https://pns.kurogames.com/" />
                        <HyperlinkButton Content="下载最新版" NavigateUri="https://github.com/BlameTwo/Haiyu/releases/latest" />
                        <HyperlinkButton Content="加入开发者的小窝" NavigateUri="https://qm.qq.com/q/4raTeh9MWI" />
                    </StackPanel>
                </Grid>
                <TextBlock
                    Margin="0,15,0,0"
                    FontFamily="{StaticResource DefaultFont}"
                    FontSize="15"
                    Text="通用" />
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    Header="启动器主题">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE790;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ComboBox ItemsSource="{x:Bind ViewModel.Themes, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectTheme, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </ui:SettingsCard>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    Header="游戏背景类型">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE8B9;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:SettingsCard.Content>
                        <ComboBox ItemsSource="{x:Bind ViewModel.WallpaperTypes, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectWallpaperName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate x:DataType="uModel:WallpaperType">
                                    <TextBlock Text="{x:Bind Name}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </ui:SettingsCard.Content>
                </ui:SettingsCard>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Description="{x:Bind a:App.AppVersion}"
                    Header="版本">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe UI Emoji" Glyph="&#x1F5DD;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:SettingsCard.Content>
                        <Button Command="{x:Bind ViewModel.UpdateVersionCommand}" Content="检查更新" />
                    </ui:SettingsCard.Content>
                </ui:SettingsCard>
                <ui:SettingsExpander Margin="0,5,0,0" Header="截图">
                    <ToggleSwitch
                        x:Name="captureSwitch"
                        IsOn="{x:Bind ViewModel.IsOn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        OffContent=""
                        OnContent="" />
                    <ui:SettingsExpander.HeaderIcon>
                        <FontIcon FontFamily="Segoe UI Emoji" Glyph="&#x1F5BC;" />
                    </ui:SettingsExpander.HeaderIcon>
                    <ui:SettingsExpander.Items>
                        <ui:SettingsCard
                            Header="截图快捷键"
                            IsClickEnabled="False"
                            IsEnabled="{x:Bind captureSwitch.IsOn, Mode=TwoWay}">
                            <StackPanel Orientation="Horizontal">
                                <ComboBox
                                    Margin="0,0,5,0"
                                    ItemsSource="{x:Bind ViewModel.CaptureModifierKeys, Mode=OneWay}"
                                    SelectedItem="{x:Bind ViewModel.CaptureModifierKey, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate x:DataType="ext:ModifierKey">
                                            <TextBlock Text="{x:Bind Name}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="18"
                                    Text="+" />
                                <ComboBox
                                    Margin="5,0,0,0"
                                    ItemsSource="{x:Bind ViewModel.CaptureKeys, Mode=OneWay}"
                                    SelectedItem="{x:Bind ViewModel.CaptureKey, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate x:DataType="ext:Keys">
                                            <TextBlock Text="{x:Bind Name}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                        </ui:SettingsCard>
                        <ui:SettingsCard
                            Command="{x:Bind ViewModel.OpenCaptureFolderCommand}"
                            Header="截图保存文件夹"
                            IsClickEnabled="True"
                            IsEnabled="{x:Bind captureSwitch.IsOn, Mode=TwoWay}" />
                    </ui:SettingsExpander.Items>
                </ui:SettingsExpander>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    Header="关闭按钮"
                    IsClickEnabled="False">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe UI Emoji" Glyph="&#x1F615;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:SettingsCard.Content>
                        <ComboBox SelectedIndex="{x:Bind ViewModel.SelectCloseIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBoxItem Content="托盘" />
                            <ComboBoxItem Content="退出" />
                        </ComboBox>
                    </ui:SettingsCard.Content>
                </ui:SettingsCard>
                <TextBlock
                    Margin="0,5,0,0"
                    FontFamily="{StaticResource DefaultFont}"
                    FontSize="15"
                    Text="库街区" />
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Command="{x:Bind ViewModel.CopyTokenCommand}"
                    Header="复制授权码"
                    IsClickEnabled="True">
                    <ui:SettingsCard.ActionIcon>
                        <FontIcon
                            FontFamily="Segoe Fluent Icons"
                            FontSize="15"
                            Glyph="&#xE8C8;" />
                    </ui:SettingsCard.ActionIcon>
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE631;" />
                    </ui:SettingsCard.HeaderIcon>
                </ui:SettingsCard>

                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Command="{x:Bind ViewModel.CopyDidCommand}"
                    Header="复制Did"
                    IsClickEnabled="True">
                    <ui:SettingsCard.ActionIcon>
                        <FontIcon
                            FontFamily="Segoe Fluent Icons"
                            FontSize="15"
                            Glyph="&#xE8C8;" />
                    </ui:SettingsCard.ActionIcon>
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE631;" />
                    </ui:SettingsCard.HeaderIcon>
                </ui:SettingsCard>
                <ui:SettingsExpander
                    Margin="0,5,0,0"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    ItemsSource="{x:Bind ViewModel.GamerData, Mode=OneWay}">
                    <ui:SettingsExpander.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xEC7A;" />
                    </ui:SettingsExpander.HeaderIcon>
                    <ui:SettingsExpander.Header>
                        <TextBlock VerticalAlignment="Center" Text="账号管理" />
                    </ui:SettingsExpander.Header>
                    <ui:SettingsExpander.ItemTemplate>
                        <DataTemplate x:DataType="gamer:GameRoilDataItem">
                            <ui:SettingsCard>
                                <ui:SettingsCard.Header>
                                    <StackPanel Orientation="Horizontal">
                                        <wui:ImageEx
                                            Width="28"
                                            Height="28"
                                            CornerRadius="5"
                                            Source="{x:Bind GameHeadUrl}" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center">
                                            <Run Text="{x:Bind RoleName}" />
                                            <Run Text="--" />
                                            <Run Text="{x:Bind ServerName}" />
                                        </TextBlock>
                                    </StackPanel>
                                </ui:SettingsCard.Header>
                                <Button
                                    Command="{x:Bind CopyIdCommand}"
                                    Style="{ThemeResource TransparentButtonStyle}"
                                    ToolTipService.ToolTip="复制账号ID">
                                    <FontIcon
                                        FontFamily="Segoe Fluent Icons"
                                        FontSize="15"
                                        Glyph="&#xE8C8;" />
                                </Button>
                            </ui:SettingsCard>
                        </DataTemplate>
                    </ui:SettingsExpander.ItemTemplate>
                </ui:SettingsExpander>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Description="程序启动时自动进行签到"
                    Header="自动签到">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xF45E;" />
                    </ui:SettingsCard.HeaderIcon>
                    <Border Width="30" MaxWidth="30">
                        <CheckBox IsChecked="{x:Bind ViewModel.AutoCommunitySign, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                    </Border>
                </ui:SettingsCard>
                <TextBlock
                    Margin="0,5,0,0"
                    FontFamily="{StaticResource DefaultFont}"
                    FontSize="15"
                    Text="存储与其他" />
                <ui:SettingsCard
                    Command="{x:Bind ViewModel.DeleteWebCacheCommandCommand}"
                    Header="删除Web缓存"
                    IsClickEnabled="True">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE74D;" />
                    </ui:SettingsCard.HeaderIcon>
                </ui:SettingsCard>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Command="{x:Bind ViewModel.OpenConfigFolderCommand}"
                    Header="配置文件夹"
                    IsClickEnabled="True">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe UI Emoji" Glyph="&#x1F4DA;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:SettingsCard.ActionIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE7AC;" />
                    </ui:SettingsCard.ActionIcon>
                </ui:SettingsCard>
                <ui:SettingsCard Margin="0,5,0,0" Header="Rpc密钥">
                    <ui:SettingsCard.Content>
                        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                            <PasswordBox
                                Width="200"
                                VerticalAlignment="Center"
                                VerticalContentAlignment="Center"
                                FontSize="18"
                                Password="{x:Bind ViewModel.RpcToken, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                PasswordChar="*"
                                PasswordRevealMode="Peek" />
                            <Button
                                Command="{x:Bind ViewModel.SetRpcTokenCommand}"
                                Content="确认"
                                Style="{ThemeResource TransparentButtonStyle}" />
                        </StackPanel>
                    </ui:SettingsCard.Content>
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE72E;" />
                    </ui:SettingsCard.HeaderIcon>

                </ui:SettingsCard>
                <ui:SettingsCard
                    Margin="0,5,0,0"
                    Command="{x:Bind ViewModel.CreateLinkCommand}"
                    Header="创建快捷方式"
                    IsClickEnabled="True">
                    <ui:SettingsCard.HeaderIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE71B;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:SettingsCard.ActionIcon>
                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xF466;" />
                    </ui:SettingsCard.ActionIcon>
                </ui:SettingsCard>
                <ui:SettingsExpander Margin="0,5,0,0" Header="诊断环境">
                    <ui:SettingsExpander.Items>
                        <ui:SettingsCard Description="观察右侧内容是否为图标，来确定图标是否正常" Header="字体文件">
                            <ui:SettingsCard.Content>
                                <StackPanel Orientation="Horizontal">
                                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xEA8C;" />
                                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xEB05;" />
                                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xEB56;" />
                                </StackPanel>
                            </ui:SettingsCard.Content>
                        </ui:SettingsCard>
                        <ui:SettingsCard Header="Web内核版本">
                            <TextBlock IsTextSelectionEnabled="True" Text="{x:Bind ViewModel.WebViewVersion, Mode=OneWay}" />
                        </ui:SettingsCard>
                        <ui:SettingsCard Header="WindowsApp Sdk">

                            <TextBlock IsTextSelectionEnabled="True" Text="{x:Bind ViewModel.WindowsAppSdkVersion, Mode=OneWay}" />
                        </ui:SettingsCard>
                        <ui:SettingsCard Header="运行类型">

                            <TextBlock IsTextSelectionEnabled="True" Text="{x:Bind ViewModel.RunType, Mode=OneWay}" />
                        </ui:SettingsCard>
                        <ui:SettingsCard Header="框架版本">
                            <TextBlock IsTextSelectionEnabled="True" Text="{x:Bind ViewModel.FrameworkType, Mode=OneWay}" />
                        </ui:SettingsCard>
                    </ui:SettingsExpander.Items>
                </ui:SettingsExpander>
            </StackPanel>
        </ScrollView>
    </Grid>
</Page>
